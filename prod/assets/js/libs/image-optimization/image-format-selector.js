"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,o)}return r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _regenerator(){var m,d,e="function"==typeof Symbol?Symbol:{},t=e.iterator||"@@iterator",r=e.toStringTag||"@@toStringTag";function o(e,t,r,o){var n,a,i,c,s,A,u,f,p,l=t&&t.prototype instanceof v?t:v,g=Object.create(l.prototype);return _regeneratorDefine2(g,"_invoke",(n=e,a=r,u=o||[],f=!1,p={p:A=0,n:0,v:m,a:y,f:y.bind(m,4),d:function(e,t){return i=e,c=0,s=m,p.n=t,b}},function(e,t,r){if(1<A)throw TypeError("Generator is already running");for(f&&1===t&&y(t,r),c=t,s=r;(d=c<2?m:s)||!f;){i||(c?c<3?(1<c&&(p.n=-1),y(c,s)):p.n=s:p.v=s);try{if(A=2,i){if(c||(e="next"),d=i[e]){if(!(d=d.call(i,s)))throw TypeError("iterator result is not an object");if(!d.done)return d;s=d.value,c<2&&(c=0)}else 1===c&&(d=i.return)&&d.call(i),c<2&&(s=TypeError("The iterator does not provide a '"+e+"' method"),c=1);i=m}else if((d=(f=p.n<0)?s:n.call(a,p))!==b)break}catch(e){i=m,c=1,s=e}finally{A=1}}return{value:d,done:f}}),!0),g;function y(e,t){for(c=e,s=t,d=0;!f&&A&&!r&&d<u.length;d++){var r,o=u[d],n=p.p,a=o[2];3<e?(r=a===t)&&(c=o[4]||3,s=o[5]===m?o[3]:o[5],o[4]=3,o[5]=m):o[0]<=n&&((r=e<2&&n<o[1])?(c=0,p.v=t,p.n=o[1]):n<a&&(r=e<3||o[0]>t||a<t)&&(o[4]=e,o[5]=t,p.n=a,c=0))}if(r||1<e)return b;throw f=!0,t}}var b={};function v(){}function n(){}function a(){}d=Object.getPrototypeOf;var i=[][t]?d(d([][t]())):(_regeneratorDefine2(d={},t,function(){return this}),d),c=a.prototype=v.prototype=Object.create(i);function s(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,a):(e.__proto__=a,_regeneratorDefine2(e,r,"GeneratorFunction")),e.prototype=Object.create(c),e}return _regeneratorDefine2(c,"constructor",n.prototype=a),_regeneratorDefine2(a,"constructor",n),_regeneratorDefine2(a,r,n.displayName="GeneratorFunction"),_regeneratorDefine2(c),_regeneratorDefine2(c,r,"Generator"),_regeneratorDefine2(c,t,function(){return this}),_regeneratorDefine2(c,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:o,m:s}})()}function _regeneratorDefine2(e,t,r,o){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}(_regeneratorDefine2=function(e,t,r,o){if(t)a?a(e,t,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[t]=r;else{var n=function(t,r){_regeneratorDefine2(e,t,function(e){return this._invoke(t,r,e)})};n("next",0),n("throw",1),n("return",2)}})(e,t,r,o)}function asyncGeneratorStep(e,t,r,o,n,a,i){try{var c=e[a](i),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(o,n)}function _asyncToGenerator(c){return function(){var e=this,i=arguments;return new Promise(function(t,r){var o=c.apply(e,i);function n(e){asyncGeneratorStep(o,t,r,n,a,"next",e)}function a(e){asyncGeneratorStep(o,t,r,n,a,"throw",e)}n(void 0)})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);var o=r.call(e,t||"default");if("object"!=_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var ImageFormatSelector=function(){return _createClass(function e(){_classCallCheck(this,e),this.formatSupport={avif:!1,webp:!1,original:!0},this.init()},[{key:"checkAvifSupport",value:(t=_asyncToGenerator(_regenerator().m(function e(){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.a(2,new Promise(function(e){var t=new Image;t.onload=t.onerror=function(){e(1===t.width&&1===t.height)},t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgABogQEAwgMg8f8D///8WfhwB8+ErK42A="}))}},e)})),function(){return t.apply(this,arguments)})},{key:"checkWebPSupport",value:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))&&0===e.toDataURL("image/webp").indexOf("data:image/webp")}},{key:"init",value:(e=_asyncToGenerator(_regenerator().m(function e(){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return console.log("ðŸ” ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¸ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¾Ð² Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹..."),this.formatSupport.webp=this.checkWebPSupport(),e.n=1,this.checkAvifSupport();case 1:this.formatSupport.avif=e.v,console.log("ðŸ“Š ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¾Ð²:",this.formatSupport),this.processImages();case 2:return e.a(2)}},e,this)})),function(){return e.apply(this,arguments)})},{key:"getAvailableFormats",value:function(e){var t=[];return e.dataset.avifSrc&&this.formatSupport.avif&&t.push({format:"avif",src:e.dataset.avifSrc,priority:parseInt(e.dataset.avifPriority)||999}),e.dataset.webpSrc&&this.formatSupport.webp&&t.push({format:"webp",src:e.dataset.webpSrc,priority:parseInt(e.dataset.webpPriority)||999}),e.dataset.jpgSrc&&t.push({format:"jpg",src:e.dataset.jpgSrc,priority:parseInt(e.dataset.jpgPriority)||999}),e.dataset.pngSrc&&t.push({format:"png",src:e.dataset.pngSrc,priority:parseInt(e.dataset.pngPriority)||999}),e.dataset.jpegSrc&&t.push({format:"jpeg",src:e.dataset.jpegSrc,priority:parseInt(e.dataset.jpegPriority)||999}),e.dataset.gifSrc&&t.push({format:"gif",src:e.dataset.gifSrc,priority:parseInt(e.dataset.gifPriority)||999}),t}},{key:"selectOptimalFormat",value:function(e){return 0===e.length?null:(e.sort(function(e,t){return e.priority-t.priority}),e[0])}},{key:"processImage",value:function(e){var t=this.getAvailableFormats(e);if(0!==t.length){var r=this.selectOptimalFormat(t);r&&r.src!==e.src&&(console.log("ðŸ”„ Ð—Ð°Ð¼ÐµÐ½Ð° Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ: ".concat(e.src," â†’ ").concat(r.src," (").concat(r.format,")")),e.src=r.src)}else console.log("âš ï¸ ÐÐµÑ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ñ… Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¾Ð² Ð´Ð»Ñ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ:",e.src)}},{key:"processImages",value:function(){var t=this;console.log("ðŸ–¼ï¸ ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹...");var e=document.querySelectorAll("img[data-avif-src], img[data-webp-src], img[data-jpg-src], img[data-png-src], img[data-jpeg-src], img[data-gif-src]");e.forEach(function(e){t.processImage(e)}),console.log("âœ… ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½Ð¾ ".concat(e.length," Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹"))}},{key:"observeNewImages",value:function(){var t=this;new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.forEach(function(e){e.nodeType===Node.ELEMENT_NODE&&("IMG"===e.tagName&&t.hasImageDataAttributes(e)&&t.processImage(e),e.querySelectorAll("img[data-avif-src], img[data-webp-src], img[data-jpg-src], img[data-png-src], img[data-jpeg-src], img[data-gif-src]").forEach(function(e){return t.processImage(e)}))})})}).observe(document.body,{childList:!0,subtree:!0}),console.log("ðŸ‘€ ÐÐ°Ð±Ð»ÑŽÐ´ÐµÐ½Ð¸Ðµ Ð·Ð° Ð½Ð¾Ð²Ñ‹Ð¼Ð¸ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸ÑÐ¼Ð¸ Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾")}},{key:"hasImageDataAttributes",value:function(e){return e.dataset.avifSrc||e.dataset.webpSrc||e.dataset.jpgSrc||e.dataset.pngSrc||e.dataset.jpegSrc||e.dataset.gifSrc}},{key:"refresh",value:function(){this.processImages()}},{key:"getFormatSupport",value:function(){return _objectSpread({},this.formatSupport)}}]);var e,t}();window.imageFormatSelector=new ImageFormatSelector,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){window.imageFormatSelector.observeNewImages()}):window.imageFormatSelector.observeNewImages();var _default=exports.default=ImageFormatSelector;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYnMvaW1hZ2Utb3B0aW1pemF0aW9uL2ltYWdlLWZvcm1hdC1zZWxlY3Rvci5qcyJdLCJuYW1lcyI6WyJlIiwidCIsInIiLCJTeW1ib2wiLCJuIiwiaXRlcmF0b3IiLCJvIiwidG9TdHJpbmdUYWciLCJpIiwiYyIsInUiLCJmIiwicCIsInkiLCJHIiwicHJvdG90eXBlIiwiR2VuZXJhdG9yIiwiT2JqZWN0IiwiY3JlYXRlIiwiX3JlZ2VuZXJhdG9yRGVmaW5lMiIsInYiLCJhIiwiZCIsImJpbmQiLCJsIiwiVHlwZUVycm9yIiwiY2FsbCIsImRvbmUiLCJ2YWx1ZSIsImxlbmd0aCIsIkdlbmVyYXRvckZ1bmN0aW9uIiwiR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUiLCJnZXRQcm90b3R5cGVPZiIsInRoaXMiLCJzZXRQcm90b3R5cGVPZiIsIl9fcHJvdG9fXyIsImRpc3BsYXlOYW1lIiwiX3JlZ2VuZXJhdG9yIiwidyIsIm0iLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsIl9pbnZva2UiLCJhc3luY0dlbmVyYXRvclN0ZXAiLCJQcm9taXNlIiwicmVzb2x2ZSIsInRoZW4iLCJfYXN5bmNUb0dlbmVyYXRvciIsImFyZ3VtZW50cyIsImFwcGx5IiwiX25leHQiLCJfdGhyb3ciLCJfY2xhc3NDYWxsQ2hlY2siLCJfZGVmaW5lUHJvcGVydGllcyIsIl90b1Byb3BlcnR5S2V5Iiwia2V5IiwiX2NyZWF0ZUNsYXNzIiwiX3RvUHJpbWl0aXZlIiwiX3R5cGVvZiIsInRvUHJpbWl0aXZlIiwiU3RyaW5nIiwiTnVtYmVyIiwiSW1hZ2VGb3JtYXRTZWxlY3RvciIsImZvcm1hdFN1cHBvcnQiLCJhdmlmIiwid2VicCIsIm9yaWdpbmFsIiwiaW5pdCIsIl9jaGVja0F2aWZTdXBwb3J0IiwiX2NhbGxlZSIsIl9jb250ZXh0IiwiaW1nIiwib25lcnJvciIsIndpZHRoIiwic3JjIiwiZWxlbSIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImdldENvbnRleHQiLCJ0b0RhdGFVUkwiLCJpbmRleE9mIiwiX2luaXQiLCJfY2FsbGVlMiIsIl9jb250ZXh0MiIsImNvbnNvbGUiLCJjaGVja1dlYlBTdXBwb3J0IiwibG9nIiwicHJvY2Vzc0ltYWdlcyIsImZvcm1hdHMiLCJkYXRhc2V0IiwiYXZpZlNyYyIsImNoZWNrQXZpZlN1cHBvcnQiLCJhdmlmUHJpb3JpdHkiLCJ3ZWJwU3JjIiwicHJpb3JpdHkiLCJwYXJzZUludCIsIndlYnBQcmlvcml0eSIsImpwZ1NyYyIsImpwZ1ByaW9yaXR5IiwicG5nU3JjIiwicHVzaCIsImZvcm1hdCIsInBuZ1ByaW9yaXR5IiwianBlZ1NyYyIsImpwZWdQcmlvcml0eSIsImdpZlNyYyIsImdldEF2YWlsYWJsZUZvcm1hdHMiLCJnaWZQcmlvcml0eSIsImF2YWlsYWJsZUZvcm1hdHMiLCJvcHRpbWFsRm9ybWF0Iiwic2VsZWN0T3B0aW1hbEZvcm1hdCIsImNvbmNhdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbWFnZXMiLCJmb3JFYWNoIiwiX3RoaXMiLCJNdXRhdGlvbk9ic2VydmVyIiwibXV0YXRpb25zIiwibXV0YXRpb24iLCJhZGRlZE5vZGVzIiwibm9kZSIsIm5vZGVUeXBlIiwiTm9kZSIsIkVMRU1FTlRfTk9ERSIsImIiLCJfdGhpczIiLCJoYXNJbWFnZURhdGFBdHRyaWJ1dGVzIiwicHJvY2Vzc0ltYWdlIiwiYm9keSIsInN1YnRyZWUiLCJlbGVtZW50IiwiX29iamVjdFNwcmVhZCIsIndpbmRvdyIsImltYWdlRm9ybWF0U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwib2JzZXJ2ZU5ld0ltYWdlcyIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Im1oQ0FDQSxJQUFBQSxFQUFBQyxFQUFBQyxFQUFBLG1CQUFBQyxPQUFBQSxPQUFBLEdBQUFDLEVBQUFGLEVBQUFHLFVBQUEsYUFBQUMsRUFBQUosRUFBQUssYUFBQSxnQkFBQSxTQUFBQyxFQUFBTixFQUFBRSxF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eUcsY0FBQSxHQUFZcEcsS0FBS2dDLG1CQTdKckIsSUFBQWtCLEVBOUJKYixFQUV5QixHQThMekJnRSxPQWhEdUJDLG9CQUFBLElBQUF2RSxvQkFHRXlELFlBZ0RyQjNDLFNBaERZMEMsV0FpRFoxQyxTQWhEZ0IwRCxpQkFBaUIsbUJBQVVYLFdBaUR2Q1MsT0FoRGdCQyxvQkFBQUUscUJBbURwQkgsT0FBT0Msb0JBaERhRSxtQkFtRHhCLElBQUFDLFNBQUFDLFFBQUEsUUEvQ3dCeEIiLCJmaWxlIjoibGlicy9pbWFnZS1vcHRpbWl6YXRpb24vaW1hZ2UtZm9ybWF0LXNlbGVjdG9yLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8g0KHQuNGB0YLQtdC80LAg0LDQstGC0L7QvNCw0YLQuNGH0LXRgdC60L7Qs9C+INCy0YvQsdC+0YDQsCDQvtC/0YLQuNC80LDQu9GM0L3QvtCz0L4g0YTQvtGA0LzQsNGC0LAg0LjQt9C+0LHRgNCw0LbQtdC90LjQuVxyXG4vLyDQn9GA0L7QstC10YDRj9C10YIg0L/QvtC00LTQtdGA0LbQutGDINCx0YDQsNGD0LfQtdGA0L7QvCDRhNC+0YDQvNCw0YLQvtCyINC4INCy0YvQsdC40YDQsNC10YIg0L3QsNC40LzQtdC90YzRiNC40Lkg0L/QviDRgNCw0LfQvNC10YDRg1xyXG5cclxuY2xhc3MgSW1hZ2VGb3JtYXRTZWxlY3RvciB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLmZvcm1hdFN1cHBvcnQgPSB7XHJcbiAgICAgICAgICAgIGF2aWY6IGZhbHNlLFxyXG4gICAgICAgICAgICB3ZWJwOiBmYWxzZSxcclxuICAgICAgICAgICAgb3JpZ2luYWw6IHRydWUgLy8gSlBHL1BORyDQstGB0LXQs9C00LAg0L/QvtC00LTQtdGA0LbQuNCy0LDRjtGC0YHRj1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g0J/RgNC+0LLQtdGA0LrQsCDQv9C+0LTQtNC10YDQttC60LggQVZJRlxyXG4gICAgYXN5bmMgY2hlY2tBdmlmU3VwcG9ydCgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaW1nID0gbmV3IEltYWdlKCk7XHJcbiAgICAgICAgICAgIGltZy5vbmxvYWQgPSBpbWcub25lcnJvciA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoaW1nLndpZHRoID09PSAxICYmIGltZy5oZWlnaHQgPT09IDEpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpbWcuc3JjID0gJ2RhdGE6aW1hZ2UvYXZpZjtiYXNlNjQsQUFBQUlHWjBlWEJoZG1sbUFBQUFBR0YyYVdadGFXWXhiV2xoWmsxQk1VSUFBQUR5YldWMFlRQUFBQUFBQUFBb2FHUnNjZ0FBQUFBQUFBQUFjR2xqZEFBQUFBQUFBQUFBQUFBQUFHeHBZbUYyYVdZQUFBQUFEbkJwZEcwQUFBQUFBQUVBQUFBZWFXeHZZd0FBQUFCRUFBQUJBQUVBQUFBQkFBQUJHZ0FBQUIwQUFBQW9hV2x1WmdBQUFBQUFBUUFBQUJwcGJtWmxBZ0FBQUFBQkFBQmhkakF4UTI5c2IzSUFBQUFBYW1sd2NuQUFBQUJMYVhCamJ3QUFBQlJwYzNCbEFBQUFBQUFBQUFFQUFBQUJBQUFBRUhCcGVHa0FBQUFBQXdnSUNBQUFBQXhoZGpGRGdRME1BQUFBQUJOamIyeHlibU5zZUFBQ0FBSUFBWUFBQUFBWGFYQnRZUUFBQUFBQUFBQUJBQUVFQVFLREJBQUFBQ1Z0WkdGMEVnQUtDQmdBQm9nUUVBd2dNZzhmOEQvLy84V2Zod0I4K0VySzQyQT0nO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vINCf0YDQvtCy0LXRgNC60LAg0L/QvtC00LTQtdGA0LbQutC4IFdlYlBcclxuICAgIGNoZWNrV2ViUFN1cHBvcnQoKSB7XHJcbiAgICAgICAgY29uc3QgZWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xyXG4gICAgICAgIHJldHVybiAhIShlbGVtLmdldENvbnRleHQgJiYgZWxlbS5nZXRDb250ZXh0KCcyZCcpKSAmJlxyXG4gICAgICAgICAgICBlbGVtLnRvRGF0YVVSTCgnaW1hZ2Uvd2VicCcpLmluZGV4T2YoJ2RhdGE6aW1hZ2Uvd2VicCcpID09PSAwO1xyXG4gICAgfVxyXG5cclxuICAgIC8vINCY0L3QuNGG0LjQsNC70LjQt9Cw0YbQuNGPINC/0YDQvtCy0LXRgNC60Lgg0L/QvtC00LTQtdGA0LbQutC4INGE0L7RgNC80LDRgtC+0LJcclxuICAgIGFzeW5jIGluaXQoKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ/CflI0g0J/RgNC+0LLQtdGA0LrQsCDQv9C+0LTQtNC10YDQttC60Lgg0YTQvtGA0LzQsNGC0L7QsiDQuNC30L7QsdGA0LDQttC10L3QuNC5Li4uJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5mb3JtYXRTdXBwb3J0LndlYnAgPSB0aGlzLmNoZWNrV2ViUFN1cHBvcnQoKTtcclxuICAgICAgICB0aGlzLmZvcm1hdFN1cHBvcnQuYXZpZiA9IGF3YWl0IHRoaXMuY2hlY2tBdmlmU3VwcG9ydCgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5OKINCf0L7QtNC00LXRgNC20LrQsCDRhNC+0YDQvNCw0YLQvtCyOicsIHRoaXMuZm9ybWF0U3VwcG9ydCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8g0JfQsNC/0YPRgdC60LDQtdC8INC+0LHRgNCw0LHQvtGC0LrRgyDQuNC30L7QsdGA0LDQttC10L3QuNC5XHJcbiAgICAgICAgdGhpcy5wcm9jZXNzSW1hZ2VzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g0J/QvtC70YPRh9C10L3QuNC1INC00L7RgdGC0YPQv9C90YvRhSDRhNC+0YDQvNCw0YLQvtCyINC00LvRjyDQuNC30L7QsdGA0LDQttC10L3QuNGPXHJcbiAgICBnZXRBdmFpbGFibGVGb3JtYXRzKGltZykge1xyXG4gICAgICAgIGNvbnN0IGZvcm1hdHMgPSBbXTtcclxuICAgICAgICBcclxuICAgICAgICAvLyDQn9GA0L7QstC10YDRj9C10LwgZGF0YS3QsNGC0YDQuNCx0YPRgtGLXHJcbiAgICAgICAgaWYgKGltZy5kYXRhc2V0LmF2aWZTcmMgJiYgdGhpcy5mb3JtYXRTdXBwb3J0LmF2aWYpIHtcclxuICAgICAgICAgICAgZm9ybWF0cy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGZvcm1hdDogJ2F2aWYnLFxyXG4gICAgICAgICAgICAgICAgc3JjOiBpbWcuZGF0YXNldC5hdmlmU3JjLFxyXG4gICAgICAgICAgICAgICAgcHJpb3JpdHk6IHBhcnNlSW50KGltZy5kYXRhc2V0LmF2aWZQcmlvcml0eSkgfHwgOTk5XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBpZiAoaW1nLmRhdGFzZXQud2VicFNyYyAmJiB0aGlzLmZvcm1hdFN1cHBvcnQud2VicCkge1xyXG4gICAgICAgICAgICBmb3JtYXRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgZm9ybWF0OiAnd2VicCcsXHJcbiAgICAgICAgICAgICAgICBzcmM6IGltZy5kYXRhc2V0LndlYnBTcmMsXHJcbiAgICAgICAgICAgICAgICBwcmlvcml0eTogcGFyc2VJbnQoaW1nLmRhdGFzZXQud2VicFByaW9yaXR5KSB8fCA5OTlcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChpbWcuZGF0YXNldC5qcGdTcmMpIHtcclxuICAgICAgICAgICAgZm9ybWF0cy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGZvcm1hdDogJ2pwZycsXHJcbiAgICAgICAgICAgICAgICBzcmM6IGltZy5kYXRhc2V0LmpwZ1NyYyxcclxuICAgICAgICAgICAgICAgIHByaW9yaXR5OiBwYXJzZUludChpbWcuZGF0YXNldC5qcGdQcmlvcml0eSkgfHwgOTk5XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBpZiAoaW1nLmRhdGFzZXQucG5nU3JjKSB7XHJcbiAgICAgICAgICAgIGZvcm1hdHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXQ6ICdwbmcnLFxyXG4gICAgICAgICAgICAgICAgc3JjOiBpbWcuZGF0YXNldC5wbmdTcmMsXHJcbiAgICAgICAgICAgICAgICBwcmlvcml0eTogcGFyc2VJbnQoaW1nLmRhdGFzZXQucG5nUHJpb3JpdHkpIHx8IDk5OVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGltZy5kYXRhc2V0LmpwZWdTcmMpIHtcclxuICAgICAgICAgICAgZm9ybWF0cy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGZvcm1hdDogJ2pwZWcnLFxyXG4gICAgICAgICAgICAgICAgc3JjOiBpbWcuZGF0YXNldC5qcGVnU3JjLFxyXG4gICAgICAgICAgICAgICAgcHJpb3JpdHk6IHBhcnNlSW50KGltZy5kYXRhc2V0LmpwZWdQcmlvcml0eSkgfHwgOTk5XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBpZiAoaW1nLmRhdGFzZXQuZ2lmU3JjKSB7XHJcbiAgICAgICAgICAgIGZvcm1hdHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBmb3JtYXQ6ICdnaWYnLFxyXG4gICAgICAgICAgICAgICAgc3JjOiBpbWcuZGF0YXNldC5naWZTcmMsXHJcbiAgICAgICAgICAgICAgICBwcmlvcml0eTogcGFyc2VJbnQoaW1nLmRhdGFzZXQuZ2lmUHJpb3JpdHkpIHx8IDk5OVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIGZvcm1hdHM7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g0JLRi9Cx0L7RgCDQvtC/0YLQuNC80LDQu9GM0L3QvtCz0L4g0YTQvtGA0LzQsNGC0LBcclxuICAgIHNlbGVjdE9wdGltYWxGb3JtYXQoZm9ybWF0cykge1xyXG4gICAgICAgIGlmIChmb3JtYXRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8g0KHQvtGA0YLQuNGA0YPQtdC8INC/0L4g0L/RgNC40L7RgNC40YLQtdGC0YMgKNGH0LXQvCDQvNC10L3RjNGI0LUg0YfQuNGB0LvQviwg0YLQtdC8INCy0YvRiNC1INC/0YDQuNC+0YDQuNGC0LXRgilcclxuICAgICAgICBmb3JtYXRzLnNvcnQoKGEsIGIpID0+IGEucHJpb3JpdHkgLSBiLnByaW9yaXR5KTtcclxuICAgICAgICBcclxuICAgICAgICAvLyDQktC+0LfQstGA0LDRidCw0LXQvCDRhNC+0YDQvNCw0YIg0YEg0L3QsNC40LLRi9GB0YjQuNC8INC/0YDQuNC+0YDQuNGC0LXRgtC+0LxcclxuICAgICAgICByZXR1cm4gZm9ybWF0c1swXTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDQntCx0YDQsNCx0L7RgtC60LAg0L7QtNC90L7Qs9C+INC40LfQvtCx0YDQsNC20LXQvdC40Y9cclxuICAgIHByb2Nlc3NJbWFnZShpbWcpIHtcclxuICAgICAgICBjb25zdCBhdmFpbGFibGVGb3JtYXRzID0gdGhpcy5nZXRBdmFpbGFibGVGb3JtYXRzKGltZyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGF2YWlsYWJsZUZvcm1hdHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfimqDvuI8g0J3QtdGCINC00L7RgdGC0YPQv9C90YvRhSDRhNC+0YDQvNCw0YLQvtCyINC00LvRjyDQuNC30L7QsdGA0LDQttC10L3QuNGPOicsIGltZy5zcmMpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IG9wdGltYWxGb3JtYXQgPSB0aGlzLnNlbGVjdE9wdGltYWxGb3JtYXQoYXZhaWxhYmxlRm9ybWF0cyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKG9wdGltYWxGb3JtYXQgJiYgb3B0aW1hbEZvcm1hdC5zcmMgIT09IGltZy5zcmMpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYPCflIQg0JfQsNC80LXQvdCwINC40LfQvtCx0YDQsNC20LXQvdC40Y86ICR7aW1nLnNyY30g4oaSICR7b3B0aW1hbEZvcm1hdC5zcmN9ICgke29wdGltYWxGb3JtYXQuZm9ybWF0fSlgKTtcclxuICAgICAgICAgICAgaW1nLnNyYyA9IG9wdGltYWxGb3JtYXQuc3JjO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyDQntCx0YDQsNCx0L7RgtC60LAg0LLRgdC10YUg0LjQt9C+0LHRgNCw0LbQtdC90LjQuSDQvdCwINGB0YLRgNCw0L3QuNGG0LVcclxuICAgIHByb2Nlc3NJbWFnZXMoKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ/CflrzvuI8g0J7QsdGA0LDQsdC+0YLQutCwINC40LfQvtCx0YDQsNC20LXQvdC40LkuLi4nKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyDQntCx0YDQsNCx0LDRgtGL0LLQsNC10Lwg0LLRgdC1IGltZyDRgtC10LPQuFxyXG4gICAgICAgIGNvbnN0IGltYWdlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2ltZ1tkYXRhLWF2aWYtc3JjXSwgaW1nW2RhdGEtd2VicC1zcmNdLCBpbWdbZGF0YS1qcGctc3JjXSwgaW1nW2RhdGEtcG5nLXNyY10sIGltZ1tkYXRhLWpwZWctc3JjXSwgaW1nW2RhdGEtZ2lmLXNyY10nKTtcclxuICAgICAgICBcclxuICAgICAgICBpbWFnZXMuZm9yRWFjaChpbWcgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NJbWFnZShpbWcpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnNvbGUubG9nKGDinIUg0J7QsdGA0LDQsdC+0YLQsNC90L4gJHtpbWFnZXMubGVuZ3RofSDQuNC30L7QsdGA0LDQttC10L3QuNC5YCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g0J7QsdGA0LDQsdC+0YLQutCwINC00LjQvdCw0LzQuNGH0LXRgdC60Lgg0LTQvtCx0LDQstC70LXQvdC90YvRhSDQuNC30L7QsdGA0LDQttC10L3QuNC5XHJcbiAgICBvYnNlcnZlTmV3SW1hZ2VzKCkge1xyXG4gICAgICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dGF0aW9ucykgPT4ge1xyXG4gICAgICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaCgobXV0YXRpb24pID0+IHtcclxuICAgICAgICAgICAgICAgIG11dGF0aW9uLmFkZGVkTm9kZXMuZm9yRWFjaCgobm9kZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLm5vZGVUeXBlID09PSBOb2RlLkVMRU1FTlRfTk9ERSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDQn9GA0L7QstC10YDRj9C10Lwg0YHQsNC8INGD0LfQtdC7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLnRhZ05hbWUgPT09ICdJTUcnICYmIHRoaXMuaGFzSW1hZ2VEYXRhQXR0cmlidXRlcyhub2RlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzSW1hZ2Uobm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vINCf0YDQvtCy0LXRgNGP0LXQvCDQtNC+0YfQtdGA0L3QuNC1INGN0LvQtdC80LXQvdGC0YtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaW1hZ2VzID0gbm9kZS5xdWVyeVNlbGVjdG9yQWxsKCdpbWdbZGF0YS1hdmlmLXNyY10sIGltZ1tkYXRhLXdlYnAtc3JjXSwgaW1nW2RhdGEtanBnLXNyY10sIGltZ1tkYXRhLXBuZy1zcmNdLCBpbWdbZGF0YS1qcGVnLXNyY10sIGltZ1tkYXRhLWdpZi1zcmNdJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlcy5mb3JFYWNoKGltZyA9PiB0aGlzLnByb2Nlc3NJbWFnZShpbWcpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShkb2N1bWVudC5ib2R5LCB7XHJcbiAgICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcclxuICAgICAgICAgICAgc3VidHJlZTogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnNvbGUubG9nKCfwn5GAINCd0LDQsdC70Y7QtNC10L3QuNC1INC30LAg0L3QvtCy0YvQvNC4INC40LfQvtCx0YDQsNC20LXQvdC40Y/QvNC4INCy0LrQu9GO0YfQtdC90L4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDQn9GA0L7QstC10YDQutCwINC90LDQu9C40YfQuNGPIGRhdGEt0LDRgtGA0LjQsdGD0YLQvtCyINC40LfQvtCx0YDQsNC20LXQvdC40LlcclxuICAgIGhhc0ltYWdlRGF0YUF0dHJpYnV0ZXMoZWxlbWVudCkge1xyXG4gICAgICAgIHJldHVybiBlbGVtZW50LmRhdGFzZXQuYXZpZlNyYyB8fCBcclxuICAgICAgICAgICAgICAgZWxlbWVudC5kYXRhc2V0LndlYnBTcmMgfHwgXHJcbiAgICAgICAgICAgICAgIGVsZW1lbnQuZGF0YXNldC5qcGdTcmMgfHwgXHJcbiAgICAgICAgICAgICAgIGVsZW1lbnQuZGF0YXNldC5wbmdTcmMgfHwgXHJcbiAgICAgICAgICAgICAgIGVsZW1lbnQuZGF0YXNldC5qcGVnU3JjIHx8IFxyXG4gICAgICAgICAgICAgICBlbGVtZW50LmRhdGFzZXQuZ2lmU3JjO1xyXG4gICAgfVxyXG5cclxuICAgIC8vINCe0LHQvdC+0LLQu9C10L3QuNC1INC40LfQvtCx0YDQsNC20LXQvdC40LkgKNC00LvRjyDRgNGD0YfQvdC+0LPQviDQstGL0LfQvtCy0LApXHJcbiAgICByZWZyZXNoKCkge1xyXG4gICAgICAgIHRoaXMucHJvY2Vzc0ltYWdlcygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vINCf0L7Qu9GD0YfQtdC90LjQtSDQuNC90YTQvtGA0LzQsNGG0LjQuCDQviDQv9C+0LTQtNC10YDQttC60LUg0YTQvtGA0LzQsNGC0L7QslxyXG4gICAgZ2V0Rm9ybWF0U3VwcG9ydCgpIHtcclxuICAgICAgICByZXR1cm4geyAuLi50aGlzLmZvcm1hdFN1cHBvcnQgfTtcclxuICAgIH1cclxufVxyXG5cclxuLy8g0KHQvtC30LTQsNC90LjQtSDQs9C70L7QsdCw0LvRjNC90L7Qs9C+INGN0LrQt9C10LzQv9C70Y/RgNCwXHJcbndpbmRvdy5pbWFnZUZvcm1hdFNlbGVjdG9yID0gbmV3IEltYWdlRm9ybWF0U2VsZWN0b3IoKTtcclxuXHJcbi8vINCd0LDQsdC70Y7QtNC10L3QuNC1INC30LAg0L3QvtCy0YvQvNC4INC40LfQvtCx0YDQsNC20LXQvdC40Y/QvNC4INC/0L7RgdC70LUg0LfQsNCz0YDRg9C30LrQuCBET01cclxuaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdsb2FkaW5nJykge1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHtcclxuICAgICAgICB3aW5kb3cuaW1hZ2VGb3JtYXRTZWxlY3Rvci5vYnNlcnZlTmV3SW1hZ2VzKCk7XHJcbiAgICB9KTtcclxufSBlbHNlIHtcclxuICAgIHdpbmRvdy5pbWFnZUZvcm1hdFNlbGVjdG9yLm9ic2VydmVOZXdJbWFnZXMoKTtcclxufVxyXG5cclxuLy8g0K3QutGB0L/QvtGA0YIg0LTQu9GPINC40YHQv9C+0LvRjNC30L7QstCw0L3QuNGPINCyINC80L7QtNGD0LvRj9GFXHJcbmV4cG9ydCBkZWZhdWx0IEltYWdlRm9ybWF0U2VsZWN0b3I7ICJdfQ==
