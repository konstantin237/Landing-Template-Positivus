"use strict";function _regenerator(){var y,v,e="function"==typeof Symbol?Symbol:{},t=e.iterator||"@@iterator",r=e.toStringTag||"@@toStringTag";function n(e,t,r,n){var o,A,a,i,c,u,f,p,s,g=t&&t.prototype instanceof h?t:h,l=Object.create(g.prototype);return _regeneratorDefine2(l,"_invoke",(o=e,A=r,f=n||[],p=!1,s={p:u=0,n:0,v:y,a:m,f:m.bind(y,4),d:function(e,t){return a=e,i=0,c=y,s.n=t,d}},function(e,t,r){if(1<u)throw TypeError("Generator is already running");for(p&&1===t&&m(t,r),i=t,c=r;(v=i<2?y:c)||!p;){a||(i?i<3?(1<i&&(s.n=-1),m(i,c)):s.n=c:s.v=c);try{if(u=2,a){if(i||(e="next"),v=a[e]){if(!(v=v.call(a,c)))throw TypeError("iterator result is not an object");if(!v.done)return v;c=v.value,i<2&&(i=0)}else 1===i&&(v=a.return)&&v.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+e+"' method"),i=1);a=y}else if((v=(p=s.n<0)?c:o.call(A,s))!==d)break}catch(e){a=y,i=1,c=e}finally{u=1}}return{value:v,done:p}}),!0),l;function m(e,t){for(i=e,c=t,v=0;!p&&u&&!r&&v<f.length;v++){var r,n=f[v],o=s.p,A=n[2];3<e?(r=A===t)&&(i=n[4]||3,c=n[5]===y?n[3]:n[5],n[4]=3,n[5]=y):n[0]<=o&&((r=e<2&&o<n[1])?(i=0,s.v=t,s.n=n[1]):o<A&&(r=e<3||n[0]>t||A<t)&&(n[4]=e,n[5]=t,s.n=A,i=0))}if(r||1<e)return d;throw p=!0,t}}var d={};function h(){}function o(){}function A(){}v=Object.getPrototypeOf;var a=[][t]?v(v([][t]())):(_regeneratorDefine2(v={},t,function(){return this}),v),i=A.prototype=h.prototype=Object.create(a);function c(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,A):(e.__proto__=A,_regeneratorDefine2(e,r,"GeneratorFunction")),e.prototype=Object.create(i),e}return _regeneratorDefine2(i,"constructor",o.prototype=A),_regeneratorDefine2(A,"constructor",o),_regeneratorDefine2(A,r,o.displayName="GeneratorFunction"),_regeneratorDefine2(i),_regeneratorDefine2(i,r,"Generator"),_regeneratorDefine2(i,t,function(){return this}),_regeneratorDefine2(i,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:n,m:c}})()}function _regeneratorDefine2(e,t,r,n){var A=Object.defineProperty;try{A({},"",{})}catch(e){A=0}(_regeneratorDefine2=function(e,t,r,n){if(t)A?A(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r;else{var o=function(t,r){_regeneratorDefine2(e,t,function(e){return this._invoke(t,r,e)})};o("next",0),o("throw",1),o("return",2)}})(e,t,r,n)}function asyncGeneratorStep(e,t,r,n,o,A,a){try{var i=e[A](a),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(n,o)}function _asyncToGenerator(i){return function(){var e=this,a=arguments;return new Promise(function(t,r){var n=i.apply(e,a);function o(e){asyncGeneratorStep(n,t,r,o,A,"next",e)}function A(e){asyncGeneratorStep(n,t,r,o,A,"throw",e)}o(void 0)})}}console.log("🎯 Демонстрация системы оптимизации изображений");var formatSupport={avif:!1,webp:!1,original:!0};function checkWebPSupport(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))&&0===e.toDataURL("image/webp").indexOf("data:image/webp")}function checkAvifSupport(){return _checkAvifSupport.apply(this,arguments)}function _checkAvifSupport(){return(_checkAvifSupport=_asyncToGenerator(_regenerator().m(function e(){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return e.a(2,new Promise(function(e){var t=new Image;t.onload=t.onerror=function(){e(1===t.width&&1===t.height)},t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgABogQEAwgMg8f8D///8WfhwB8+ErK42A="}))}},e)}))).apply(this,arguments)}function initImageOptimization(){return _initImageOptimization.apply(this,arguments)}function _initImageOptimization(){return(_initImageOptimization=_asyncToGenerator(_regenerator().m(function e(){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:return console.log("🔍 Проверка поддержки форматов..."),formatSupport.webp=checkWebPSupport(),e.n=1,checkAvifSupport();case 1:formatSupport.avif=e.v,console.log("📊 Поддержка форматов:",formatSupport),document.querySelectorAll("img[data-avif-src]").forEach(function(e){console.log("🖼️ Обработка изображения:",e.src);var t=[];if(e.dataset.avifSrc&&formatSupport.avif&&t.push({format:"AVIF",src:e.dataset.avifSrc,priority:parseInt(e.dataset.avifPriority)}),e.dataset.webpSrc&&formatSupport.webp&&t.push({format:"WebP",src:e.dataset.webpSrc,priority:parseInt(e.dataset.webpPriority)}),e.dataset.jpgSrc&&t.push({format:"JPG",src:e.dataset.jpgSrc,priority:parseInt(e.dataset.jpgPriority)}),0<t.length){t.sort(function(e,t){return e.priority-t.priority});var r=t[0];console.log("✅ Выбран формат: ".concat(r.format," (приоритет: ").concat(r.priority,")")),r.src!==e.src&&(console.log("🔄 Замена: ".concat(e.src," → ").concat(r.src)),e.src=r.src)}}),console.log("✅ Обработка изображений завершена");case 2:return e.a(2)}},e)}))).apply(this,arguments)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initImageOptimization):initImageOptimization();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYnMvaW1hZ2Utb3B0aW1pemF0aW9uL2RlbW8taW1hZ2Utb3B0aW1pemF0aW9uLmpzIl0sIm5hbWVzIjpbImUiLCJ0IiwiciIsIlN5bWJvbCIsIm4iLCJpdGVyYXRvciIsIm8iLCJ0b1N0cmluZ1RhZyIsImkiLCJjIiwidSIsImYiLCJwIiwieSIsIkciLCJwcm90b3R5cGUiLCJHZW5lcmF0b3IiLCJPYmplY3QiLCJjcmVhdGUiLCJfcmVnZW5lcmF0b3JEZWZpbmUyIiwidiIsImEiLCJkIiwiYmluZCIsImwiLCJUeXBlRXJyb3IiLCJjYWxsIiwiZG9uZSIsInZhbHVlIiwibGVuZ3RoIiwiR2VuZXJhdG9yRnVuY3Rpb24iLCJHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSIsImdldFByb3RvdHlwZU9mIiwidGhpcyIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiZGlzcGxheU5hbWUiLCJfcmVnZW5lcmF0b3IiLCJ3IiwibSIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiX2ludm9rZSIsImFzeW5jR2VuZXJhdG9yU3RlcCIsIlByb21pc2UiLCJyZXNvbHZlIiwidGhlbiIsIl9hc3luY1RvR2VuZXJhdG9yIiwiYXJndW1lbnRzIiwiYXBwbHkiLCJfbmV4dCIsIl90aHJvdyIsImNvbnNvbGUiLCJsb2ciLCJmb3JtYXRTdXBwb3J0IiwiYXZpZiIsIm9yaWdpbmFsIiwiY2hlY2tXZWJQU3VwcG9ydCIsImVsZW0iLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJnZXRDb250ZXh0IiwidG9EYXRhVVJMIiwiaW5kZXhPZiIsIl9jaGVja0F2aWZTdXBwb3J0IiwiX2NhbGxlZSIsIl9jb250ZXh0IiwiaW1nIiwiSW1hZ2UiLCJvbmxvYWQiLCJvbmVycm9yIiwiY2hlY2tBdmlmU3VwcG9ydCIsImhlaWdodCIsInNyYyIsImluaXRJbWFnZU9wdGltaXphdGlvbiIsIl9pbml0SW1hZ2VPcHRpbWl6YXRpb24iLCJfY2FsbGVlMiIsIl9jb250ZXh0MiIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJhdmlmU3JjIiwiaW1hZ2VzIiwicHVzaCIsInByaW9yaXR5IiwicGFyc2VJbnQiLCJkYXRhc2V0IiwiYXZpZlByaW9yaXR5Iiwid2VicCIsImF2YWlsYWJsZUZvcm1hdHMiLCJ3ZWJwU3JjIiwid2VicFByaW9yaXR5IiwianBnU3JjIiwiZm9ybWF0Iiwic29ydCIsImIiLCJjb25jYXQiLCJvcHRpbWFsIiwianBnUHJpb3JpdHkiLCJyZWFkeVN0YXRlIiwiYWRkRXZlbnRMaXN0ZW5lciJdLCJtYXBwaW5ncyI6InFDQUNBLElBQUFBLEVBQUFDLEVBQUFDLEVBQUEsbUJBQUFDLE9BQUFBLE9BQUEsR0FBQUMsRUFBQUYsRUFBQUcsVUFBQSxhQUFBQyxFQUFBSixFQUFBSyxhQUFBLGdCQUFBLFNBQUFDLEVBQUFOLEVBQUFFLEVBQUFFLEVBQUFFLEdBQUEsSUFBQU4sRUFBQUUsRUFBQUksRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUwsRUFBQUwsR0FBQUEsRUFBQVcscUJBQUFDLEVBQUFaLEVBQUFZLEVBQUFOLEVBQUFPLE9BQUFDLE9BQUFULEVBQUFNLFdBQUEsT0FBQUksb0JBQUFULEVBQUEsV0FBQVIsRUFBQUEsRUFBQUUsRUFBQUUsRUFBQU0sRUFBQUosR0FBQSxHQUFBSyxHQUFBLEVBQUFDLEVBQUEsQ0FBQUYsRUFBQUQsRUFBQSxFQUFBUCxFQUFBLEVBQUFnQixFQUFBcEIsRUFBQXFCLEVBQUFDLEVBQUFYLEVBQUFXLEVBQUFDLEtBQUF2QixFQUFBLEdBQUFzQixFQUFBLFNBQUFyQixFQUFBQyxHQUFBLE9BQUFNLEVBQUFQLEVBQUFRLEVBQUEsRUFBQUMsRUFBQVYsRUFBQWMsRUFBQVYsRUFBQUYsRUFBQW1CLElBQUEsU0FBQWYsRUFBQU0sRUFBQVksR0FBQSxHQUFBLEVBQUFiLEVBQUEsTUFBQWMsVUFBQSxnQ0FBQSxJQUFBWixHQUFBLElBQUFELEdBQUFVLEVBQUFWLEVBQUFZLEdBQUFm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QixXQWZPLFlBa0JKVyxTQWxCSXNDLFdBbUJKdEMsU0FsQkl1QyxpQkFBSVgsbUJBQTZCYix1QkFvQnJDQSIsImZpbGUiOiJsaWJzL2ltYWdlLW9wdGltaXphdGlvbi9kZW1vLWltYWdlLW9wdGltaXphdGlvbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG4vLyDQlNC10LzQvtC90YHRgtGA0LDRhtC40L7QvdC90LDRjyDRgdC40YHRgtC10LzQsCDQstGL0LHQvtGA0LAg0YTQvtGA0LzQsNGC0L7QsiDQuNC30L7QsdGA0LDQttC10L3QuNC5XHJcbmNvbnNvbGUubG9nKCfwn46vINCU0LXQvNC+0L3RgdGC0YDQsNGG0LjRjyDRgdC40YHRgtC10LzRiyDQvtC/0YLQuNC80LjQt9Cw0YbQuNC4INC40LfQvtCx0YDQsNC20LXQvdC40LknKTtcclxuXHJcbi8vINCf0YDQvtCy0LXRgNC60LAg0L/QvtC00LTQtdGA0LbQutC4INGE0L7RgNC80LDRgtC+0LJcclxuY29uc3QgZm9ybWF0U3VwcG9ydCA9IHtcclxuICAgIGF2aWY6IGZhbHNlLFxyXG4gICAgd2VicDogZmFsc2UsXHJcbiAgICBvcmlnaW5hbDogdHJ1ZVxyXG59O1xyXG5cclxuLy8g0J/RgNC+0LLQtdGA0LrQsCBXZWJQXHJcbmZ1bmN0aW9uIGNoZWNrV2ViUFN1cHBvcnQoKSB7XHJcbiAgICBjb25zdCBlbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XHJcbiAgICByZXR1cm4gISEoZWxlbS5nZXRDb250ZXh0ICYmIGVsZW0uZ2V0Q29udGV4dCgnMmQnKSkgJiZcclxuICAgICAgICBlbGVtLnRvRGF0YVVSTCgnaW1hZ2Uvd2VicCcpLmluZGV4T2YoJ2RhdGE6aW1hZ2Uvd2VicCcpID09PSAwO1xyXG59XHJcblxyXG4vLyDQn9GA0L7QstC10YDQutCwIEFWSUZcclxuYXN5bmMgZnVuY3Rpb24gY2hlY2tBdmlmU3VwcG9ydCgpIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGltZyA9IG5ldyBJbWFnZSgpO1xyXG4gICAgICAgIGltZy5vbmxvYWQgPSBpbWcub25lcnJvciA9ICgpID0+IHtcclxuICAgICAgICAgICAgcmVzb2x2ZShpbWcud2lkdGggPT09IDEgJiYgaW1nLmhlaWdodCA9PT0gMSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBpbWcuc3JjID0gJ2RhdGE6aW1hZ2UvYXZpZjtiYXNlNjQsQUFBQUlHWjBlWEJoZG1sbUFBQUFBR0YyYVdadGFXWXhiV2xoWmsxQk1VSUFBQUR5YldWMFlRQUFBQUFBQUFBb2FHUnNjZ0FBQUFBQUFBQUFjR2xqZEFBQUFBQUFBQUFBQUFBQUFHeHBZbUYyYVdZQUFBQUFEbkJwZEcwQUFBQUFBQUVBQUFBZWFXeHZZd0FBQUFCRUFBQUJBQUVBQUFBQkFBQUJHZ0FBQUIwQUFBQW9hV2x1WmdBQUFBQUFBUUFBQUJwcGJtWmxBZ0FBQUFBQkFBQmhkakF4UTI5c2IzSUFBQUFBYW1sd2NuQUFBQUJMYVhCamJ3QUFBQlJwYzNCbEFBQUFBQUFBQUFFQUFBQUJBQUFBRUhCcGVHa0FBQUFBQXdnSUNBQUFBQXhoZGpGRGdRME1BQUFBQUJOamIyeHlibU5zZUFBQ0FBSUFBWUFBQUFBWGFYQnRZUUFBQUFBQUFBQUJBQUVFQVFLREJBQUFBQ1Z0WkdGMEVnQUtDQmdBQm9nUUVBd2dNZzhmOEQvLy84V2Zod0I4K0VySzQyQT0nO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vINCe0YHQvdC+0LLQvdCw0Y8g0YTRg9C90LrRhtC40Y9cclxuYXN5bmMgZnVuY3Rpb24gaW5pdEltYWdlT3B0aW1pemF0aW9uKCkge1xyXG4gICAgY29uc29sZS5sb2coJ/CflI0g0J/RgNC+0LLQtdGA0LrQsCDQv9C+0LTQtNC10YDQttC60Lgg0YTQvtGA0LzQsNGC0L7Qsi4uLicpO1xyXG4gICAgXHJcbiAgICBmb3JtYXRTdXBwb3J0LndlYnAgPSBjaGVja1dlYlBTdXBwb3J0KCk7XHJcbiAgICBmb3JtYXRTdXBwb3J0LmF2aWYgPSBhd2FpdCBjaGVja0F2aWZTdXBwb3J0KCk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKCfwn5OKINCf0L7QtNC00LXRgNC20LrQsCDRhNC+0YDQvNCw0YLQvtCyOicsIGZvcm1hdFN1cHBvcnQpO1xyXG4gICAgXHJcbiAgICAvLyDQntCx0YDQsNCx0LDRgtGL0LLQsNC10Lwg0LjQt9C+0LHRgNCw0LbQtdC90LjRj1xyXG4gICAgY29uc3QgaW1hZ2VzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnaW1nW2RhdGEtYXZpZi1zcmNdJyk7XHJcbiAgICBcclxuICAgIGltYWdlcy5mb3JFYWNoKGltZyA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ/CflrzvuI8g0J7QsdGA0LDQsdC+0YLQutCwINC40LfQvtCx0YDQsNC20LXQvdC40Y86JywgaW1nLnNyYyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgYXZhaWxhYmxlRm9ybWF0cyA9IFtdO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vINCf0YDQvtCy0LXRgNGP0LXQvCDQtNC+0YHRgtGD0L/QvdGL0LUg0YTQvtGA0LzQsNGC0YtcclxuICAgICAgICBpZiAoaW1nLmRhdGFzZXQuYXZpZlNyYyAmJiBmb3JtYXRTdXBwb3J0LmF2aWYpIHtcclxuICAgICAgICAgICAgYXZhaWxhYmxlRm9ybWF0cy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGZvcm1hdDogJ0FWSUYnLFxyXG4gICAgICAgICAgICAgICAgc3JjOiBpbWcuZGF0YXNldC5hdmlmU3JjLFxyXG4gICAgICAgICAgICAgICAgcHJpb3JpdHk6IHBhcnNlSW50KGltZy5kYXRhc2V0LmF2aWZQcmlvcml0eSlcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChpbWcuZGF0YXNldC53ZWJwU3JjICYmIGZvcm1hdFN1cHBvcnQud2VicCkge1xyXG4gICAgICAgICAgICBhdmFpbGFibGVGb3JtYXRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgZm9ybWF0OiAnV2ViUCcsXHJcbiAgICAgICAgICAgICAgICBzcmM6IGltZy5kYXRhc2V0LndlYnBTcmMsXHJcbiAgICAgICAgICAgICAgICBwcmlvcml0eTogcGFyc2VJbnQoaW1nLmRhdGFzZXQud2VicFByaW9yaXR5KVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGltZy5kYXRhc2V0LmpwZ1NyYykge1xyXG4gICAgICAgICAgICBhdmFpbGFibGVGb3JtYXRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgZm9ybWF0OiAnSlBHJyxcclxuICAgICAgICAgICAgICAgIHNyYzogaW1nLmRhdGFzZXQuanBnU3JjLFxyXG4gICAgICAgICAgICAgICAgcHJpb3JpdHk6IHBhcnNlSW50KGltZy5kYXRhc2V0LmpwZ1ByaW9yaXR5KVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8g0JLRi9Cx0LjRgNCw0LXQvCDQvtC/0YLQuNC80LDQu9GM0L3Ri9C5INGE0L7RgNC80LDRglxyXG4gICAgICAgIGlmIChhdmFpbGFibGVGb3JtYXRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgYXZhaWxhYmxlRm9ybWF0cy5zb3J0KChhLCBiKSA9PiBhLnByaW9yaXR5IC0gYi5wcmlvcml0eSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG9wdGltYWwgPSBhdmFpbGFibGVGb3JtYXRzWzBdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYOKchSDQktGL0LHRgNCw0L0g0YTQvtGA0LzQsNGCOiAke29wdGltYWwuZm9ybWF0fSAo0L/RgNC40L7RgNC40YLQtdGCOiAke29wdGltYWwucHJpb3JpdHl9KWApO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKG9wdGltYWwuc3JjICE9PSBpbWcuc3JjKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg8J+UhCDQl9Cw0LzQtdC90LA6ICR7aW1nLnNyY30g4oaSICR7b3B0aW1hbC5zcmN9YCk7XHJcbiAgICAgICAgICAgICAgICBpbWcuc3JjID0gb3B0aW1hbC5zcmM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coJ+KchSDQntCx0YDQsNCx0L7RgtC60LAg0LjQt9C+0LHRgNCw0LbQtdC90LjQuSDQt9Cw0LLQtdGA0YjQtdC90LAnKTtcclxufVxyXG5cclxuLy8g0JfQsNC/0YPRgdC60LDQtdC8INC/0YDQuCDQt9Cw0LPRgNGD0LfQutC1IERPTVxyXG5pZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2xvYWRpbmcnKSB7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgaW5pdEltYWdlT3B0aW1pemF0aW9uKTtcclxufSBlbHNlIHtcclxuICAgIGluaXRJbWFnZU9wdGltaXphdGlvbigpO1xyXG59XHJcbiJdfQ==
